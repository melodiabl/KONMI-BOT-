import{a4 as Ne,c as oe,r as u,R as Y,U as Me,f as U,u as Pe,o as be,j as e,a as H,b as D,I as Te,a5 as Fe,a6 as Le,a7 as ze,a8 as ce,a9 as G,J as De,t as Ee,h as _e,n as Oe,i as le,A as Be,k as Re,B as k,V as N,F as de,H as We,T as d,q as L,m as _,s as z,S as Ue,l as ue,y as He,z as Ve,C as $e,E as X,G as qe,M as Ge,v as Je,w as Qe,x as Ke,p as Z}from"./index-CRkNY6ry.js";import{i as Ye,E as Xe,D as he,C as ee,c as se,w as Ze,L as es,a1 as ss,a2 as ne,r as xe,g as ns,y as os,R as ts,b as rs}from"./index.esm-CzniNAqg.js";import{u as me}from"./useMutation-tt7yEThG.js";import{u as is}from"./useQuery-B78dU_LM.js";import{I as as,a as cs}from"./input-element-D4QcLV82.js";import{I as ls}from"./input-BR2M-WI7.js";import{S as ge,F as ds}from"./select-C8GCKjda.js";import{F as us}from"./form-label-DaOodn7p.js";import{S as hs}from"./switch-B-2mnAik.js";import{T as xs,a as ms,b as pe,c as R,d as gs,e as W}from"./tr-Cbx9FMhk.js";import{T as ps}from"./tooltip-DDxb5mqh.js";import{M as js,a as fs}from"./modal-footer-B3ZHaos3.js";import{u as bs}from"./use-controllable-state-ixhYjrLh.js";import"./use-checkbox-CV8AuttE.js";const V=n=>{const{condition:o,message:r}=n},[ys,K]=oe({name:"AccordionStylesContext",hookName:"useAccordionStyles",providerName:"<Accordion />"}),[vs,te]=oe({name:"AccordionItemContext",hookName:"useAccordionItemContext",providerName:"<AccordionItem />"}),[Ss,Qs,As,Cs]=Ne();function ws(n){const{onChange:o,defaultIndex:r,index:i,allowMultiple:c,allowToggle:l,...a}=n;Ns(n),Ms(n);const b=As(),[y,g]=u.useState(-1);u.useEffect(()=>()=>{g(-1)},[]);const[s,j]=bs({value:i,defaultValue(){return c?r??[]:r??-1},onChange:o});return{index:s,setIndex:j,htmlProps:a,getAccordionItemProps:h=>{let S=!1;return h!==null&&(S=Array.isArray(s)?s.includes(h):s===h),{isOpen:S,onChange:x=>{if(h!==null)if(c&&Array.isArray(s)){const w=x?s.concat(h):s.filter(M=>M!==h);j(w)}else x?j(h):l&&j(-1)}}},focusedIndex:y,setFocusedIndex:g,descendants:b}}const[Is,re]=oe({name:"AccordionContext",hookName:"useAccordionContext",providerName:"Accordion"});function ks(n){const{isDisabled:o,isFocusable:r,id:i,...c}=n,{getAccordionItemProps:l,setFocusedIndex:a}=re(),b=u.useRef(null),y=u.useId(),g=i??y,s=`accordion-button-${g}`,j=`accordion-panel-${g}`;Ps(n);const{register:C,index:h,descendants:S}=Cs({disabled:o&&!r}),{isOpen:v,onChange:x}=l(h===-1?null:h);Ts({isOpen:v,isDisabled:o});const w=()=>{x==null||x(!0)},M=()=>{x==null||x(!1)},P=u.useCallback(()=>{x==null||x(!v),a(h)},[h,a,v,x]),E=u.useCallback(T=>{const F={ArrowDown:()=>{const p=S.nextEnabled(h);p==null||p.node.focus()},ArrowUp:()=>{const p=S.prevEnabled(h);p==null||p.node.focus()},Home:()=>{const p=S.firstEnabled();p==null||p.node.focus()},End:()=>{const p=S.lastEnabled();p==null||p.node.focus()}}[T.key];F&&(T.preventDefault(),F(T))},[S,h]),f=u.useCallback(()=>{a(h)},[a,h]),$=u.useCallback(function(I={},F=null){return{...I,type:"button",ref:Me(C,b,F),id:s,disabled:!!o,"aria-expanded":!!v,"aria-controls":j,onClick:Y(I.onClick,P),onFocus:Y(I.onFocus,f),onKeyDown:Y(I.onKeyDown,E)}},[s,o,v,P,f,E,j,C]),q=u.useCallback(function(I={},F=null){return{...I,ref:F,role:"region",id:j,"aria-labelledby":s,hidden:!v}},[s,v,j]);return{isOpen:v,isDisabled:o,isFocusable:r,onOpen:w,onClose:M,getButtonProps:$,getPanelProps:q,htmlProps:c}}function Ns(n){const o=n.index||n.defaultIndex,r=o!=null&&!Array.isArray(o)&&n.allowMultiple;V({condition:!!r,message:`If 'allowMultiple' is passed, then 'index' or 'defaultIndex' must be an array. You passed: ${typeof o},`})}function Ms(n){V({condition:!!(n.allowMultiple&&n.allowToggle),message:"If 'allowMultiple' is passed, 'allowToggle' will be ignored. Either remove 'allowToggle' or 'allowMultiple' depending on whether you want multiple accordions visible or not"})}function Ps(n){V({condition:!!(n.isFocusable&&!n.isDisabled),message:`Using only 'isFocusable', this prop is reserved for situations where you pass 'isDisabled' but you still want the element to receive focus (A11y). Either remove it or pass 'isDisabled' as well.
    `})}function Ts(n){V({condition:n.isOpen&&!!n.isDisabled,message:"Cannot open a disabled accordion item"})}const ye=U(function({children:o,reduceMotion:r,...i},c){const l=Pe("Accordion",i),a=be(i),{htmlProps:b,descendants:y,...g}=ws(a),s=u.useMemo(()=>({...g,reduceMotion:!!r}),[g,r]);return e.jsx(Ss,{value:y,children:e.jsx(Is,{value:s,children:e.jsx(ys,{value:l,children:e.jsx(H.div,{ref:c,...b,className:D("chakra-accordion",i.className),__css:l.root,children:o})})})})});ye.displayName="Accordion";const ve=U(function(o,r){const{getButtonProps:i}=te(),c=i(o,r),a={display:"flex",alignItems:"center",width:"100%",outline:0,...K().button};return e.jsx(H.button,{...c,className:D("chakra-accordion__button",o.className),__css:a})});ve.displayName="AccordionButton";function Se(n){const{isOpen:o,isDisabled:r}=te(),{reduceMotion:i}=re(),c=D("chakra-accordion__icon",n.className),l=K(),a={opacity:r?.4:1,transform:o?"rotate(-180deg)":void 0,transition:i?void 0:"transform 0.2s",transformOrigin:"center",...l.icon};return e.jsx(Te,{viewBox:"0 0 24 24","aria-hidden":!0,className:c,__css:a,...n,children:e.jsx("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"})})}Se.displayName="AccordionIcon";const Ae=U(function(o,r){const{children:i,className:c}=o,{htmlProps:l,...a}=ks(o),b=K(),y=Fe({...b.container,overflowAnchor:"none"}),g=u.useMemo(()=>a,[a]);return e.jsx(vs,{value:g,children:e.jsx(H.div,{ref:r,...l,className:D("chakra-accordion__item",c),__css:y,children:typeof i=="function"?i({isExpanded:!!a.isOpen,isDisabled:!!a.isDisabled}):i})})});Ae.displayName="AccordionItem";const Fs=n=>n!=null&&parseInt(n.toString(),10)>0,je={exit:{height:{duration:.2,ease:G.ease},opacity:{duration:.3,ease:G.ease}},enter:{height:{duration:.3,ease:G.ease},opacity:{duration:.4,ease:G.ease}}},Ls={exit:({animateOpacity:n,startingHeight:o,transition:r,transitionEnd:i,delay:c})=>({...n&&{opacity:Fs(o)?1:0},height:o,transitionEnd:i==null?void 0:i.exit,transition:(r==null?void 0:r.exit)??ce.exit(je.exit,c)}),enter:({animateOpacity:n,endingHeight:o,transition:r,transitionEnd:i,delay:c})=>({...n&&{opacity:1},height:o,transitionEnd:i==null?void 0:i.enter,transition:(r==null?void 0:r.enter)??ce.enter(je.enter,c)})},Ce=u.forwardRef((n,o)=>{const{in:r,unmountOnExit:i,animateOpacity:c=!0,startingHeight:l=0,endingHeight:a="auto",style:b,className:y,transition:g,transitionEnd:s,animatePresenceProps:j,...C}=n,[h,S]=u.useState(!1);u.useEffect(()=>{const P=setTimeout(()=>{S(!0)});return()=>clearTimeout(P)},[]),V({condition:Number(l)>0&&!!i,message:"startingHeight and unmountOnExit are mutually exclusive. You can't use them together"});const v=parseFloat(l.toString())>0,x={startingHeight:l,endingHeight:a,animateOpacity:c,transition:h?g:{enter:{duration:0}},transitionEnd:{enter:s==null?void 0:s.enter,exit:i?s==null?void 0:s.exit:{...s==null?void 0:s.exit,display:v?"block":"none"}}},w=i?r:!0,M=r||i?"enter":"exit";return e.jsx(Le,{...j,initial:!1,custom:x,children:w&&e.jsx(ze.div,{ref:o,...C,className:D("chakra-collapse",y),style:{overflow:"hidden",display:"block",...b},custom:x,variants:Ls,initial:i?"exit":!1,animate:M,exit:"exit"})})});Ce.displayName="Collapse";const we=U(function(o,r){const{className:i,motionProps:c,...l}=o,{reduceMotion:a}=re(),{getPanelProps:b,isOpen:y}=te(),g=b(l,r),s=D("chakra-accordion__panel",i),j=K();a||delete g.hidden;const C=e.jsx(H.div,{...g,__css:j.panel,className:s});return a?C:e.jsx(Ce,{in:y,...c,children:C})});we.displayName="AccordionPanel";const Q=U(function(o,r){const i=De("Code",o),{className:c,...l}=be(o);return e.jsx(H.code,{ref:r,className:D("chakra-code",o.className),...l,__css:{display:"inline-block",...i}})});Q.displayName="Code";const J={error:"red",warn:"orange",info:"blue",debug:"gray",trace:"purple"},fe={error:xe,warn:xe,info:ne,debug:ss,trace:es},Ks=()=>{var ae;const[n,o]=u.useState(""),[r,i]=u.useState(""),[c,l]=u.useState(""),[a,b]=u.useState(1),[y,g]=u.useState(!0),[s,j]=u.useState(null),[C,h]=u.useState(5e3),{isOpen:S,onOpen:v,onClose:x}=Ee(),w=_e(),M=Oe(),P=le("white","gray.700"),E=le("gray.200","gray.600"),{data:f,isLoading:$,error:q}=is(["logs",a,n,r,c],()=>Z.getLogs(a,50,r),{refetchInterval:y?C:!1}),T=me(()=>Z.clearLogs(),{onSuccess:()=>{M.invalidateQueries("logs"),w({title:"Logs limpiados",description:"Los logs han sido limpiados exitosamente",status:"success"})},onError:t=>{var m,A;w({title:"Error",description:((A=(m=t.response)==null?void 0:m.data)==null?void 0:A.message)||"Error al limpiar logs",status:"error"})}}),I=me(()=>Z.exportLogs(),{onSuccess:t=>{const m=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),A=URL.createObjectURL(m),B=document.createElement("a");B.href=A,B.download=`logs-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(A),w({title:"Logs exportados",description:"Los logs han sido exportados exitosamente",status:"success"})},onError:t=>{var m,A;w({title:"Error",description:((A=(m=t.response)==null?void 0:m.data)==null?void 0:A.message)||"Error al exportar logs",status:"error"})}}),F=()=>{window.confirm("¿Estás seguro de que quieres limpiar todos los logs? Esta acción no se puede deshacer.")&&T.mutate()},p=()=>{I.mutate()},Ie=t=>{j(t),v()},ie=t=>{const m=new Date(t);return{date:m.toLocaleDateString(),time:m.toLocaleTimeString(),full:m.toLocaleString()}},ke=(t,m=100)=>t.length<=m?t:t.substring(0,m)+"...",O=(()=>{if(!(f!=null&&f.logs))return{};const t={error:0,warn:0,info:0,debug:0,trace:0};return f.logs.forEach(m=>{t[m.level]!==void 0&&t[m.level]++}),t})();return q?e.jsxs(Be,{status:"error",children:[e.jsx(Re,{}),"Error al cargar logs: ",q.message]}):e.jsxs(k,{children:[e.jsxs(N,{spacing:6,align:"stretch",children:[e.jsxs(de,{align:"center",justify:"space-between",children:[e.jsxs(k,{children:[e.jsx(We,{size:"lg",children:"Logs del Sistema"}),e.jsx(d,{color:"gray.600",mt:1,children:"Monitoreo y gestión de logs del sistema"})]}),e.jsxs(L,{spacing:3,children:[e.jsx(_,{leftIcon:e.jsx(Ye,{}),colorScheme:"blue",variant:"outline",onClick:()=>M.invalidateQueries("logs"),isLoading:$,children:"Actualizar"}),e.jsx(_,{leftIcon:e.jsx(Xe,{}),colorScheme:"green",variant:"outline",onClick:p,isLoading:I.isLoading,children:"Exportar"}),e.jsx(_,{leftIcon:e.jsx(he,{}),colorScheme:"red",variant:"outline",onClick:F,isLoading:T.isLoading,children:"Limpiar"})]})]}),e.jsx(ee,{bg:P,border:"1px",borderColor:E,children:e.jsx(se,{children:e.jsxs(L,{spacing:8,justify:"center",children:[e.jsxs(N,{children:[e.jsx(z,{colorScheme:"red",size:"lg",children:O.error||0}),e.jsx(d,{fontSize:"sm",fontWeight:"semibold",children:"Error"})]}),e.jsxs(N,{children:[e.jsx(z,{colorScheme:"orange",size:"lg",children:O.warn||0}),e.jsx(d,{fontSize:"sm",fontWeight:"semibold",children:"Warning"})]}),e.jsxs(N,{children:[e.jsx(z,{colorScheme:"blue",size:"lg",children:O.info||0}),e.jsx(d,{fontSize:"sm",fontWeight:"semibold",children:"Info"})]}),e.jsxs(N,{children:[e.jsx(z,{colorScheme:"gray",size:"lg",children:O.debug||0}),e.jsx(d,{fontSize:"sm",fontWeight:"semibold",children:"Debug"})]}),e.jsxs(N,{children:[e.jsx(z,{colorScheme:"purple",size:"lg",children:O.trace||0}),e.jsx(d,{fontSize:"sm",fontWeight:"semibold",children:"Trace"})]})]})})}),e.jsx(ee,{bg:P,border:"1px",borderColor:E,children:e.jsx(se,{children:e.jsxs(L,{spacing:4,wrap:"wrap",children:[e.jsxs(as,{maxW:"300px",children:[e.jsx(cs,{pointerEvents:"none",children:e.jsx(Ze,{color:"gray.300"})}),e.jsx(ls,{placeholder:"Buscar en logs...",value:n,onChange:t=>o(t.target.value)})]}),e.jsxs(ge,{placeholder:"Filtrar por nivel",value:r,onChange:t=>i(t.target.value),maxW:"200px",children:[e.jsx("option",{value:"error",children:"Error"}),e.jsx("option",{value:"warn",children:"Warning"}),e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"debug",children:"Debug"}),e.jsx("option",{value:"trace",children:"Trace"})]}),e.jsxs(ge,{placeholder:"Filtrar por servicio",value:c,onChange:t=>l(t.target.value),maxW:"200px",children:[e.jsx("option",{value:"api",children:"API"}),e.jsx("option",{value:"bot",children:"Bot"}),e.jsx("option",{value:"database",children:"Database"}),e.jsx("option",{value:"auth",children:"Auth"})]}),e.jsxs(ds,{display:"flex",alignItems:"center",maxW:"200px",children:[e.jsx(us,{mb:"0",fontSize:"sm",children:"Auto-refresh"}),e.jsx(hs,{isChecked:y,onChange:t=>g(t.target.checked),colorScheme:"blue"})]})]})})}),e.jsx(ee,{bg:P,border:"1px",borderColor:E,children:e.jsxs(se,{children:[$?e.jsxs(k,{textAlign:"center",py:8,children:[e.jsx(Ue,{size:"xl"}),e.jsx(d,{mt:4,children:"Cargando logs..."})]}):e.jsx(k,{overflowX:"auto",children:e.jsxs(xs,{variant:"simple",size:"sm",children:[e.jsx(ms,{children:e.jsxs(pe,{children:[e.jsx(R,{children:"Nivel"}),e.jsx(R,{children:"Mensaje"}),e.jsx(R,{children:"Servicio"}),e.jsx(R,{children:"Timestamp"}),e.jsx(R,{children:"Acciones"})]})}),e.jsx(gs,{children:(ae=f==null?void 0:f.logs)==null?void 0:ae.map(t=>{const m=fe[t.level]||ne,A=ie(t.timestamp);return e.jsxs(pe,{children:[e.jsx(W,{children:e.jsxs(L,{children:[e.jsx(k,{as:m,color:`${J[t.level]}.500`}),e.jsx(z,{colorScheme:J[t.level]||"gray",variant:"subtle",children:t.level.toUpperCase()})]})}),e.jsx(W,{children:e.jsxs(N,{align:"start",spacing:1,children:[e.jsx(d,{fontSize:"sm",fontWeight:"medium",children:ke(t.message)}),t.metadata&&e.jsxs(d,{fontSize:"xs",color:"gray.500",children:[JSON.stringify(t.metadata).substring(0,50),"..."]})]})}),e.jsx(W,{children:e.jsx(d,{fontSize:"sm",color:"gray.600",children:t.service||"N/A"})}),e.jsx(W,{children:e.jsxs(N,{align:"start",spacing:0,children:[e.jsx(d,{fontSize:"sm",children:A.date}),e.jsx(d,{fontSize:"xs",color:"gray.500",children:A.time})]})}),e.jsx(W,{children:e.jsxs(L,{spacing:2,children:[e.jsx(ps,{label:"Ver detalles",children:e.jsx(ue,{"aria-label":"Ver detalles",icon:e.jsx(ns,{}),size:"sm",variant:"ghost",colorScheme:"blue",onClick:()=>Ie(t)})}),e.jsxs(He,{children:[e.jsx(Ve,{as:ue,"aria-label":"Más opciones",icon:e.jsx(os,{}),size:"sm",variant:"ghost"}),e.jsxs($e,{children:[e.jsx(X,{icon:e.jsx(ts,{}),children:"Copiar mensaje"}),e.jsx(X,{icon:e.jsx(rs,{}),children:"Ver usuario"}),e.jsx(qe,{}),e.jsx(X,{icon:e.jsx(he,{}),color:"red.500",children:"Eliminar log"})]})]})]})})]},t.id)})})]})}),(f==null?void 0:f.pagination)&&e.jsx(de,{justify:"center",mt:6,children:e.jsxs(L,{spacing:2,children:[e.jsx(_,{size:"sm",onClick:()=>b(a-1),isDisabled:a===1,children:"Anterior"}),e.jsxs(d,{children:["Página ",a," de ",f.pagination.totalPages]}),e.jsx(_,{size:"sm",onClick:()=>b(a+1),isDisabled:a===f.pagination.totalPages,children:"Siguiente"})]})})]})})]}),e.jsxs(Ge,{isOpen:S,onClose:x,size:"xl",children:[e.jsx(Je,{}),e.jsxs(js,{children:[e.jsx(Qe,{children:e.jsxs(L,{children:[e.jsx(k,{as:fe[s==null?void 0:s.level]||ne,color:`${J[s==null?void 0:s.level]}.500`}),e.jsx(d,{children:"Detalles del Log"})]})}),e.jsx(Ke,{children:s&&e.jsxs(N,{spacing:4,align:"stretch",children:[e.jsxs(k,{children:[e.jsx(d,{fontWeight:"semibold",mb:2,children:"Información General"}),e.jsxs(L,{justify:"space-between",children:[e.jsxs(d,{fontSize:"sm",children:["ID: ",s.id]}),e.jsx(z,{colorScheme:J[s.level],children:s.level.toUpperCase()})]}),e.jsxs(d,{fontSize:"sm",children:["Servicio: ",s.service||"N/A"]}),e.jsxs(d,{fontSize:"sm",children:["Timestamp: ",ie(s.timestamp).full]})]}),e.jsxs(k,{children:[e.jsx(d,{fontWeight:"semibold",mb:2,children:"Mensaje"}),e.jsx(Q,{p:3,borderRadius:"md",display:"block",whiteSpace:"pre-wrap",children:s.message})]}),s.metadata&&e.jsxs(k,{children:[e.jsx(d,{fontWeight:"semibold",mb:2,children:"Metadatos"}),e.jsx(Q,{p:3,borderRadius:"md",display:"block",children:JSON.stringify(s.metadata,null,2)})]}),s.stack_trace&&e.jsx(ye,{allowToggle:!0,children:e.jsxs(Ae,{children:[e.jsxs(ve,{children:[e.jsx(k,{flex:"1",textAlign:"left",children:e.jsx(d,{fontWeight:"semibold",children:"Stack Trace"})}),e.jsx(Se,{})]}),e.jsx(we,{children:e.jsx(Q,{p:3,borderRadius:"md",display:"block",whiteSpace:"pre-wrap",fontSize:"xs",children:s.stack_trace})})]})})]})}),e.jsx(fs,{children:e.jsx(_,{onClick:x,children:"Cerrar"})})]})]})]})};export{Ks as Logs,Ks as default};
//# sourceMappingURL=Logs-DqUfLo94.js.map
