import{f as k,u as K,o as Y,j as e,c as J,a as Q,b as B,I as h,r as p,d as X,e as ee,g as se,h as re,i as v,B as y,V as x,H as ae,T as m,D as R,A as oe,k as ne,l as te,m as ie}from"./index-CRkNY6ry.js";import{F as z,a as le,b as D,C as ce,c as de,d as ue,e as me,f as he,g as ge,h as pe}from"./index.esm-CzniNAqg.js";import{u as T,F as I,S as xe}from"./select-C8GCKjda.js";import{F as S}from"./form-label-DaOodn7p.js";import{I as N,a as _,b as je}from"./input-element-D4QcLV82.js";import{I as L}from"./input-BR2M-WI7.js";const[fe,be]=J({name:"FormErrorStylesContext",errorMessage:`useFormErrorStyles returned is 'undefined'. Seems you forgot to wrap the components in "<FormError />" `}),j=k((r,d)=>{const n=K("FormError",r),t=Y(r),a=T();return a!=null&&a.isInvalid?e.jsx(fe,{value:n,children:e.jsx(Q.div,{...a==null?void 0:a.getErrorMessageProps(t,d),className:B("chakra-form__error-message",r.className),__css:{display:"flex",alignItems:"center",...n.text}})}):null});j.displayName="FormErrorMessage";const ve=k((r,d)=>{const n=be(),t=T();if(!(t!=null&&t.isInvalid))return null;const a=B("chakra-form__error-icon",r.className);return e.jsx(h,{ref:d,"aria-hidden":!0,...r,__css:n.icon,className:a,children:e.jsx("path",{fill:"currentColor",d:"M11.983,0a12.206,12.206,0,0,0-8.51,3.653A11.8,11.8,0,0,0,0,12.207,11.779,11.779,0,0,0,11.8,24h.214A12.111,12.111,0,0,0,24,11.791h0A11.766,11.766,0,0,0,11.983,0ZM10.5,16.542a1.476,1.476,0,0,1,1.449-1.53h.027a1.527,1.527,0,0,1,1.523,1.47,1.475,1.475,0,0,1-1.449,1.53h-.027A1.529,1.529,0,0,1,10.5,16.542ZM11,12.5v-6a1,1,0,0,1,2,0v6a1,1,0,1,1-2,0Z"})})});ve.displayName="FormErrorIcon";const P=[{value:"owner",label:"Propietario",icon:z,color:"purple.500",description:"Acceso total al sistema"},{value:"admin",label:"Administrador",icon:z,color:"red.500",description:"Acceso completo al sistema"},{value:"moderador",label:"Moderador",icon:le,color:"green.500",description:"Moderación de grupos"},{value:"usuario",label:"Usuario",icon:D,color:"gray.500",description:"Acceso básico"}],Ee=()=>{var C,E;const[r,d]=p.useState({username:"",password:"",role:""}),[n,t]=p.useState(!1),[a,w]=p.useState(!1),[o,f]=p.useState({}),{login:W}=X(),O=ee(),H=se(),F=re(),U=v("white","gray.700"),V=v("gray.200","gray.600"),Z=v("linear(to-br, blue.50, purple.50)","linear(to-br, gray.900, blue.900)"),$=((E=(C=H.state)==null?void 0:C.from)==null?void 0:E.pathname)||"/",q=()=>{const s={};return r.username.trim()||(s.username="El nombre de usuario es requerido"),r.password?r.password.length<6&&(s.password="La contraseña debe tener al menos 6 caracteres"):s.password="La contraseña es requerida",r.role||(s.role="Debe seleccionar un rol"),f(s),Object.keys(s).length===0},b=(s,g)=>{d(c=>({...c,[s]:g})),o[s]&&f(c=>({...c,[s]:void 0}))},G=async s=>{var g,c,A,M;if(s.preventDefault(),!!q()){w(!0),f({});try{await W(r.username,r.password),F({title:"¡Bienvenido!",description:`Has iniciado sesión como ${r.role}`,status:"success",duration:3e3,isClosable:!0}),O($,{replace:!0})}catch(l){console.error("Error de login:",l);let u="Error al iniciar sesión";((g=l.response)==null?void 0:g.status)===401?u="Credenciales incorrectas":((c=l.response)==null?void 0:c.status)===403?u="No tienes permisos para acceder con este rol":(M=(A=l.response)==null?void 0:A.data)!=null&&M.message?u=l.response.data.message:l.message&&(u=l.message),F({title:"Error de autenticación",description:u,status:"error",duration:5e3,isClosable:!0})}finally{w(!1)}}},i=P.find(s=>s.value===r.role);return e.jsx(y,{minH:"100vh",bgGradient:Z,display:"flex",alignItems:"center",justifyContent:"center",p:4,children:e.jsx(ce,{maxW:"md",w:"full",bg:U,border:"1px",borderColor:V,shadow:"xl",borderRadius:"xl",children:e.jsx(de,{p:8,children:e.jsxs(x,{spacing:6,align:"stretch",children:[e.jsxs(x,{spacing:3,textAlign:"center",children:[e.jsx(y,{p:3,borderRadius:"full",bg:"green.500",color:"white",fontSize:"2xl",children:e.jsx(ue,{})}),e.jsx(ae,{size:"lg",color:"gray.700",children:"KONMI BOT Panel"}),e.jsx(m,{color:"gray.600",fontSize:"sm",children:"Inicia sesión para acceder al sistema de gestión"})]}),e.jsx(R,{}),e.jsx("form",{onSubmit:G,children:e.jsxs(x,{spacing:4,align:"stretch",children:[e.jsxs(I,{isInvalid:!!o.role,children:[e.jsx(S,{fontWeight:"semibold",children:"Rol de Usuario"}),e.jsxs(xe,{value:r.role,onChange:s=>b("role",s.target.value),size:"lg",borderRadius:"md",placeholder:"Selecciona un rol",children:[e.jsx("option",{value:"",disabled:!0,children:"Selecciona un rol"}),P.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),o.role&&e.jsx(j,{children:o.role})]}),i&&e.jsxs(oe,{status:"info",borderRadius:"md",bg:`${i.color}50`,border:"1px",borderColor:`${i.color}200`,children:[e.jsx(ne,{color:i.color}),e.jsxs(y,{children:[e.jsx(m,{fontWeight:"semibold",color:i.color,children:i.label}),e.jsx(m,{fontSize:"sm",color:"gray.600",children:i.description})]})]}),e.jsxs(I,{isInvalid:!!o.username,children:[e.jsx(S,{fontWeight:"semibold",children:"Usuario"}),e.jsxs(N,{size:"lg",children:[e.jsx(_,{pointerEvents:"none",children:e.jsx(h,{as:D,color:"gray.400"})}),e.jsx(L,{type:"text",placeholder:"Ingresa tu usuario",value:r.username,onChange:s=>b("username",s.target.value),borderRadius:"md"})]}),o.username&&e.jsx(j,{children:o.username})]}),e.jsxs(I,{isInvalid:!!o.password,children:[e.jsx(S,{fontWeight:"semibold",children:"Contraseña"}),e.jsxs(N,{size:"lg",children:[e.jsx(_,{pointerEvents:"none",children:e.jsx(h,{as:me,color:"gray.400"})}),e.jsx(L,{type:n?"text":"password",placeholder:"Ingresa tu contraseña",value:r.password,onChange:s=>b("password",s.target.value),borderRadius:"md"}),e.jsx(je,{children:e.jsx(te,{"aria-label":n?"Ocultar contraseña":"Mostrar contraseña",icon:e.jsx(h,{as:n?he:ge}),onClick:()=>t(!n),variant:"ghost",size:"sm"})})]}),o.password&&e.jsx(j,{children:o.password})]}),e.jsx(ie,{type:"submit",colorScheme:"green",size:"lg",leftIcon:e.jsx(h,{as:pe}),isLoading:a,loadingText:"Iniciando sesión...",borderRadius:"md",_hover:{transform:"translateY(-2px)",boxShadow:"lg"},transition:"all 0.2s",children:"Iniciar Sesión"})]})}),e.jsx(R,{}),e.jsxs(x,{spacing:2,textAlign:"center",children:[e.jsx(m,{fontSize:"sm",color:"gray.500",children:"¿Problemas para acceder?"}),e.jsx(m,{fontSize:"xs",color:"gray.400",children:"Contacta al administrador del sistema"})]})]})})})})};export{Ee as Login,Ee as default};
//# sourceMappingURL=Login-bLeeR3lh.js.map
