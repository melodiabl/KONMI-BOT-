import{h as N,n as Q,i as M,p as b,j as e,B as y,S as V,H as u,V as v,F as J,T as r,q as n,m as F,I as p,s as g,A as k,k as D}from"./index-CRkNY6ry.js";import{i as K,C as a,d as O,c as h,j as X,k as Y,l as Z,m as _,n as $,o as S,p as ee,q as se,r as ie}from"./index.esm-CzniNAqg.js";import{u as H}from"./useMutation-tt7yEThG.js";import{u as B}from"./useQuery-B78dU_LM.js";import{C as w}from"./card-header-s4sK_o_H.js";import{S as G}from"./simple-grid-6k9JvjOk.js";import{S as x,a as j,b as t,c as m}from"./stat-number-Cmk69z9o.js";import{S as E}from"./stat-arrow-RnLMkZWe.js";import{P as f}from"./progress-L6EjqW44.js";const je=()=>{const A=N(),U=Q(),c=M("white","gray.700"),l=M("gray.200","gray.600"),{data:o,isLoading:L}=B("botStatus",b.getBotStatus),{data:d,isLoading:W}=B("dashboardStats",b.getStats),{data:s}=B("userStats",b.getUsuarioStats),{data:i}=B("groupStats",b.getGroupStats),T=H(b.restartBot,{onSuccess:()=>{U.invalidateQueries("botStatus"),A({title:"Bot reiniciado",description:"El bot ha sido reiniciado exitosamente",status:"success"})},onError:P=>{var z,C;A({title:"Error",description:((C=(z=P.response)==null?void 0:z.data)==null?void 0:C.message)||"Error al reiniciar el bot",status:"error"})}}),q=H(b.disconnectBot,{onSuccess:()=>{U.invalidateQueries("botStatus"),A({title:"Bot desconectado",description:"El bot ha sido desconectado exitosamente",status:"success"})},onError:P=>{var z,C;A({title:"Error",description:((C=(z=P.response)==null?void 0:z.data)==null?void 0:C.message)||"Error al desconectar el bot",status:"error"})}}),I=()=>{window.confirm("¿Estás seguro de que quieres reiniciar el bot?")&&T.mutate()},R=()=>{window.confirm("¿Estás seguro de que quieres desconectar el bot?")&&q.mutate()};return L||W?e.jsxs(y,{textAlign:"center",py:10,children:[e.jsx(V,{size:"xl"}),e.jsx(u,{mt:4,children:"Cargando dashboard..."})]}):e.jsx(y,{children:e.jsxs(v,{spacing:6,align:"stretch",children:[e.jsxs(J,{align:"center",justify:"space-between",children:[e.jsxs(y,{children:[e.jsx(u,{size:"lg",children:"Dashboard"}),e.jsx(r,{color:"gray.600",mt:1,children:"Panel de control y estadísticas del sistema"})]}),e.jsx(n,{spacing:3,children:e.jsx(F,{leftIcon:e.jsx(K,{}),colorScheme:"blue",variant:"outline",onClick:()=>U.invalidateQueries(),isLoading:L||W,children:"Actualizar"})})]}),e.jsxs(a,{bg:c,border:"1px",borderColor:l,children:[e.jsx(w,{children:e.jsxs(n,{children:[e.jsx(p,{as:O,color:"green.500"}),e.jsx(u,{size:"md",children:"Estado del Bot"})]})}),e.jsxs(h,{children:[e.jsxs(G,{columns:{base:1,md:4},spacing:6,children:[e.jsxs(x,{children:[e.jsx(j,{children:"Estado de Conexión"}),e.jsx(t,{color:o!=null&&o.connected?"green.400":"red.400",children:o!=null&&o.connected?"Conectado":"Desconectado"}),e.jsxs(m,{children:[e.jsx(p,{as:o!=null&&o.connected?X:Y,mr:1}),o!=null&&o.connected?"Bot activo":"Bot inactivo"]})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Número de Teléfono"}),e.jsx(t,{fontSize:"lg",children:(o==null?void 0:o.phone)||"No disponible"}),e.jsx(m,{children:"WhatsApp conectado"})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Tiempo Activo"}),e.jsx(t,{children:(o==null?void 0:o.uptime)||"0h 0m"}),e.jsxs(m,{children:[e.jsx(p,{as:Z,mr:1}),"Uptime del bot"]})]}),e.jsxs(x,{children:[e.jsx(j,{children:"Última Actividad"}),e.jsx(t,{fontSize:"sm",children:o!=null&&o.lastSeen?new Date(o.lastSeen).toLocaleString():"N/A"}),e.jsx(m,{children:"Última vez activo"})]})]}),e.jsxs(n,{mt:6,spacing:4,children:[e.jsx(F,{leftIcon:e.jsx(_,{}),colorScheme:"green",onClick:I,isLoading:T.isLoading,isDisabled:!(o!=null&&o.connected),children:"Reiniciar Bot"}),e.jsx(F,{leftIcon:e.jsx($,{}),colorScheme:"red",variant:"outline",onClick:R,isLoading:q.isLoading,isDisabled:!(o!=null&&o.connected),children:"Desconectar Bot"})]})]})]}),e.jsxs(G,{columns:{base:1,md:2,lg:4},spacing:6,children:[e.jsx(a,{bg:c,border:"1px",borderColor:l,children:e.jsx(h,{children:e.jsxs(x,{children:[e.jsx(j,{children:e.jsxs(n,{children:[e.jsx(p,{as:S,color:"blue.500"}),e.jsx(r,{children:"Total Usuarios"})]})}),e.jsx(t,{children:(s==null?void 0:s.totalUsuarios)||0}),e.jsxs(m,{children:[e.jsx(E,{type:"increase"}),(s==null?void 0:s.usuariosActivos)||0," activos"]})]})})}),e.jsx(a,{bg:c,border:"1px",borderColor:l,children:e.jsx(h,{children:e.jsxs(x,{children:[e.jsx(j,{children:e.jsxs(n,{children:[e.jsx(p,{as:ee,color:"green.500"}),e.jsx(r,{children:"Total Grupos"})]})}),e.jsx(t,{children:(i==null?void 0:i.totalGrupos)||0}),e.jsxs(m,{children:[e.jsx(E,{type:"increase"}),(i==null?void 0:i.gruposAutorizados)||0," autorizados"]})]})})}),e.jsx(a,{bg:c,border:"1px",borderColor:l,children:e.jsx(h,{children:e.jsxs(x,{children:[e.jsx(j,{children:e.jsxs(n,{children:[e.jsx(p,{as:se,color:"purple.500"}),e.jsx(r,{children:"Total Aportes"})]})}),e.jsx(t,{children:(d==null?void 0:d.totalAportes)||0}),e.jsxs(m,{children:[e.jsx(E,{type:"increase"}),"Contenido compartido"]})]})})}),e.jsx(a,{bg:c,border:"1px",borderColor:l,children:e.jsx(h,{children:e.jsxs(x,{children:[e.jsx(j,{children:e.jsxs(n,{children:[e.jsx(p,{as:ie,color:"orange.500"}),e.jsx(r,{children:"Pedidos Pendientes"})]})}),e.jsx(t,{children:(d==null?void 0:d.pedidosPendientes)||0}),e.jsxs(m,{children:[e.jsx(E,{type:"decrease"}),"Requieren atención"]})]})})})]}),e.jsxs(G,{columns:{base:1,lg:2},spacing:6,children:[e.jsxs(a,{bg:c,border:"1px",borderColor:l,children:[e.jsx(w,{children:e.jsx(u,{size:"md",children:"Usuarios por Rol"})}),e.jsx(h,{children:e.jsxs(v,{spacing:4,align:"stretch",children:[e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(g,{colorScheme:"red",children:"Admin"}),e.jsx(r,{fontSize:"sm",children:"Administradores"})]}),e.jsx(r,{fontWeight:"semibold",children:(s==null?void 0:s.totalAdmins)||0})]}),e.jsx(f,{value:((s==null?void 0:s.totalAdmins)||0)/((s==null?void 0:s.totalUsuarios)||1)*100,colorScheme:"red"}),e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(g,{colorScheme:"blue",children:"Creador"}),e.jsx(r,{fontSize:"sm",children:"Creadores"})]}),e.jsx(r,{fontWeight:"semibold",children:(s==null?void 0:s.totalCreadores)||0})]}),e.jsx(f,{value:((s==null?void 0:s.totalCreadores)||0)/((s==null?void 0:s.totalUsuarios)||1)*100,colorScheme:"blue"}),e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(g,{colorScheme:"green",children:"Moderador"}),e.jsx(r,{fontSize:"sm",children:"Moderadores"})]}),e.jsx(r,{fontWeight:"semibold",children:(s==null?void 0:s.totalModeradores)||0})]}),e.jsx(f,{value:((s==null?void 0:s.totalModeradores)||0)/((s==null?void 0:s.totalUsuarios)||1)*100,colorScheme:"green"}),e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(g,{colorScheme:"gray",children:"Usuario"}),e.jsx(r,{fontSize:"sm",children:"Usuarios"})]}),e.jsx(r,{fontWeight:"semibold",children:(s==null?void 0:s.totalUsuarios)-((s==null?void 0:s.totalAdmins)||0)-((s==null?void 0:s.totalCreadores)||0)-((s==null?void 0:s.totalModeradores)||0)||0})]}),e.jsx(f,{value:((s==null?void 0:s.totalUsuarios)-((s==null?void 0:s.totalAdmins)||0)-((s==null?void 0:s.totalCreadores)||0)-((s==null?void 0:s.totalModeradores)||0)||0)/((s==null?void 0:s.totalUsuarios)||1)*100,colorScheme:"gray"})]})})]}),e.jsxs(a,{bg:c,border:"1px",borderColor:l,children:[e.jsx(w,{children:e.jsx(u,{size:"md",children:"Estado de Grupos"})}),e.jsx(h,{children:e.jsxs(v,{spacing:4,align:"stretch",children:[e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(g,{colorScheme:"green",children:"Autorizados"}),e.jsx(r,{fontSize:"sm",children:"Grupos autorizados"})]}),e.jsx(r,{fontWeight:"semibold",children:(i==null?void 0:i.gruposAutorizados)||0})]}),e.jsx(f,{value:((i==null?void 0:i.gruposAutorizados)||0)/((i==null?void 0:i.totalGrupos)||1)*100,colorScheme:"green"}),e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(g,{colorScheme:"blue",children:"Proveedores"}),e.jsx(r,{fontSize:"sm",children:"Grupos proveedores"})]}),e.jsx(r,{fontWeight:"semibold",children:(i==null?void 0:i.gruposProveedores)||0})]}),e.jsx(f,{value:((i==null?void 0:i.gruposProveedores)||0)/((i==null?void 0:i.totalGrupos)||1)*100,colorScheme:"blue"}),e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(g,{colorScheme:"red",children:"No autorizados"}),e.jsx(r,{fontSize:"sm",children:"Grupos pendientes"})]}),e.jsx(r,{fontWeight:"semibold",children:((i==null?void 0:i.totalGrupos)||0)-((i==null?void 0:i.gruposAutorizados)||0)})]}),e.jsx(f,{value:(((i==null?void 0:i.totalGrupos)||0)-((i==null?void 0:i.gruposAutorizados)||0))/((i==null?void 0:i.totalGrupos)||1)*100,colorScheme:"red"})]})})]})]}),(!(o!=null&&o.connected)||((d==null?void 0:d.pedidosPendientes)||0)>0)&&e.jsxs(a,{bg:c,border:"1px",borderColor:l,children:[e.jsx(w,{children:e.jsx(u,{size:"md",children:"Alertas del Sistema"})}),e.jsx(h,{children:e.jsxs(v,{spacing:3,align:"stretch",children:[!(o!=null&&o.connected)&&e.jsxs(k,{status:"error",children:[e.jsx(D,{}),e.jsxs(y,{children:[e.jsx(r,{fontWeight:"semibold",children:"Bot desconectado"}),e.jsx(r,{fontSize:"sm",children:"El bot de WhatsApp no está conectado. Revisa la conexión."})]})]}),((d==null?void 0:d.pedidosPendientes)||0)>0&&e.jsxs(k,{status:"warning",children:[e.jsx(D,{}),e.jsxs(y,{children:[e.jsx(r,{fontWeight:"semibold",children:"Pedidos pendientes"}),e.jsxs(r,{fontSize:"sm",children:["Hay ",d.pedidosPendientes," pedidos que requieren atención."]})]})]})]})})]})]})})};export{je as Dashboard,je as default};
//# sourceMappingURL=Dashboard-BAJsRjDd.js.map
