// test-handlers-simple.js
// Test simple para verificar que los handlers funcionan en runtime

console.log('üß™ Iniciando pruebas de handlers...\n');

async function testHandlers() {
  try {
    // Test 1: Importar commands.js
    console.log('1Ô∏è‚É£ Probando importaci√≥n de commands.js...');
    const commands = await import('./commands.js');
    console.log('‚úÖ commands.js importado correctamente');
    console.log('   Exports:', Object.keys(commands).join(', '));

    // Test 2: Importar download-commands.js
    console.log('\n2Ô∏è‚É£ Probando importaci√≥n de download-commands.js...');
    const downloadCommands = await import('./commands/download-commands.js');
    console.log('‚úÖ download-commands.js importado correctamente');
    console.log('   Exports:', Object.keys(downloadCommands).filter(k => k !== 'default').join(', '));

    // Test 3: Importar api-providers.js
    console.log('\n3Ô∏è‚É£ Probando importaci√≥n de api-providers.js...');
    const apiProviders = await import('./utils/api-providers.js');
    console.log('‚úÖ api-providers.js importado correctamente');
    console.log('   Exports:', Object.keys(apiProviders).filter(k => k !== 'default').join(', '));

    // Test 4: Probar handleAI
    console.log('\n4Ô∏è‚É£ Probando handleAI...');
    const testAI = await commands.handleAI(
      'Hola',
      'test@s.whatsapp.net',
      'test_group',
      new Date().toISOString()
    );
    console.log('‚úÖ handleAI ejecutado');
    console.log('   Result:', testAI.success ? 'SUCCESS' : 'EXPECTED (no API key)');

    // Test 5: Probar handleQuote
    console.log('\n5Ô∏è‚É£ Probando handleQuote...');
    const testQuote = await downloadCommands.handleQuote('test_user');
    console.log('‚úÖ handleQuote ejecutado');
    console.log('   Result:', testQuote.success ? 'SUCCESS' : 'FAILED');
    if (testQuote.message) {
      console.log('   Message preview:', testQuote.message.substring(0, 80) + '...');
    }

    // Test 6: Verificar que whatsapp.js puede importar todo
    console.log('\n6Ô∏è‚É£ Probando importaciones de whatsapp.js...');
    const whatsapp = await import('./whatsapp.js');
    console.log('‚úÖ whatsapp.js importado correctamente');

    console.log('\nüéâ TODAS LAS PRUEBAS PASARON\n');
    console.log('‚úÖ Los handlers est√°n correctamente configurados');
    console.log('‚úÖ Las importaciones funcionan');
    console.log('‚úÖ Los comandos pueden ejecutarse');

  } catch (error) {
    console.error('\n‚ùå ERROR EN LAS PRUEBAS:');
    console.error('   Message:', error.message);
    console.error('   Stack:', error.stack);
    process.exit(1);
  }
}

testHandlers();
